<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Weather Dashboard</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />
    <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-dark">
      <a class="navbar-brand text-white" href="./index.html"
        >Weather Dashboard</a
      >
    </nav>
    <!-- search form and card -->
    <div class="containter">
      <div class="row">
        <div class="col-sm-3">
          <form id="city-form">
            <div class="form-group">
              <label for="city-name" class="form label"
                >Search for a City:</label
              >
              <input type="text" class="form-control" id="city-name" />
            </div>
            <button type="submit" class="btn btn-search">Search</button>
          </form>
          <!-- form group -->
        </div>
        <div class="col-sm-9">
            <div class="row" >
                <div class="col-12" id="city-data"></div>
            </div>
            
            <div class="row">
                <div class="col-12">
                    <h1>5 Day Forecast:</h1>
                    <div class="weather-forecast" style="width: 8rem; height: 150px; background-color: blue;">
                        <div class="card-body rounded">
                          <h5 class="card-title"></h5>
                          <h6 class="card-subtitle mb-2 text-muted"></h6>
                          <p class="card-text"></p>
                          <a href="#" class="card-link"></a>
                          <a href="#" class="card-link"></a>
                        </div>
                      </div>
                </div>
            </div>
        </div>
        <!-- <div class="col-sm-9">
            <h id="forecast" class="card">5 Day Forecast:</h>
          <div id="city-data" class="card"></div>
          <div id="forcast-section" class="d-none">
            
            <div class="row">
              <div class="column">
                <div class="card-deck">
                    <div class="card">
                      <img class="card-img-top" src="..." alt="Card image cap">
              </div>
            </div>
          </div> -->
        </div>
      </div>
    </div>
    

    <script type="text/javascript">
      $(document).ready(function () {
        //DOM variables
        //Javascript variables
        var searchCityArray = [];
        //functions definition
        for (var i = 0; i < searchCityArray.length; i++) {
          var button = $("<button>")
            .addClass("btn btn-search")
            .text(searchCityArray[i]);
          $(".btn btn-search").append(button);
        }
        //function calls
        // renderButtons();
        //event listener

        $(".btn-search").on("click", function (e) {
          e.preventDefault();
          console.log("You've searched for something.");
          var newCitySearch = $("#city-name").val();
          searchCityArray.push(newCitySearch);
          localStorage.setItem("searchCityArray", searchCityArray);
          var cityName = newCitySearch;
          var queryURL =
            "http://api.openweathermap.org/data/2.5/weather?q=" +
            cityName +
            "&appid=de9e8f2ea3d90fcbbef4dedd2ac9d04a";

          $.ajax({
            url: queryURL,
            method: "GET",
          }).then(function (response) {
            $("#city-data").empty();
            console.log(response);
            var dateString = new Date(1608502800 * 1000).toLocaleDateString(
              "en-US"
            );

            var icon = $("<img>").attr(
              "src",
              `https://api.openweathermap.org/img/w/${response.weather[0].icon}.png`
            );
            var title = $("<h1>").text(cityName + " " + dateString);
            title.append(icon);

            var temperature = $("<p>").text(
              "Temperature " + response.main.temp + " F"
            );
            var humidity = $("<p>").text(
              "Humidity " + response.main.humidity + " %"
            );
            var windSpeed = $("<p>").text(
              "Wind Speed " + response.wind.speed + " MPH"
            );
            // title.attr("style", "float:left")
            $("#city-data").append(title);
            $("#city-data").append(temperature);
            $("#city-data").append(humidity);
            $("#city-data").append(windSpeed);
            console.log(response.coord.lat);
            $.ajax({
              url:
                "http://api.openweathermap.org/data/2.5/uvi?lat=" +
                response.coord.lat +
                "&lon=" +
                response.coord.lon +
                "&appid=de9e8f2ea3d90fcbbef4dedd2ac9d04a",
              method: "GET",
            }).then(function (response) {
              console.log(response);
              console.log(response.value);

              var uvIndex = $("<p>").text("UV Index " + response.value);

              $("#city-data").append(uvIndex);

              // api.openweathermap.org/data/2.5/forecast?q={city name}&appid={API key}

              //     $.ajax({
              //   url:
              //     "http://api.openweathermap.org/data/2.5/forecast?q=" +

              //     cityName +

              //     "&appid=de9e8f2ea3d90fcbbef4dedd2ac9d04a",
              //   method: "GET",
              // }).then(function (response) {
            });
          });
        });
      });
    </script>
  </body>
</html>
